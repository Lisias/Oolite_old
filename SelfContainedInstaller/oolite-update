#
# Oolite Updater Script
# Dylan Smith, 2005-09-10
#
if [ ! $OOLITE_ROOT ]
then
   echo "This program has not been properly installed. Please read the"
   echo "Oolite-installer README.TXT file and consider this a gentle LART."
   echo
   exit
fi

which rsync 2>/dev/null >/dev/null
if [ $? != 0 ]
then
   echo "No rsync, no oolite update!"
   echo "---------------------------"
   echo "Sorry, you don't seem to have rsync installed."
   echo "To install it, depending on your distro, run one of the following:"
   echo "Debian-style distros: apt-get install rsync"
   echo "Redhattish distros: up2date -i rsync"
   echo "Other RPM distros: yum install rsync"
   echo "Gentoo users should know what to do already"
   echo
   echo "Then run oolite-update again."
   echo
   exit
fi

cd $OOLITE_ROOT/$TOPLEVEL
CURRENTVER=`cat release.txt`
rsync -rl rsync://rsync.alioth.net/oolite-linux/* .
if [ $? != 0 ]
then
   echo "Rsync died and returned $?. Please try running oolite-update again"
   echo "if the problem was caused by network or other transient issues."
   echo
   exit
fi

NEWVER=`cat release.txt`

if [ $CURRENTVER != $NEWVER ]
then
   echo "Oolite was upgraded from $CURRENTVER to $NEWVER"
   exit
fi
echo "Oolite was already up to date - no changes made"

